# 8장 테스트 가능한 설계

## 테스트가 어려운 코드

테스트 하기 어려운 여러 사례를 살펴본다.
* 하드 코딩된 경로
  * 하드 코딩된 경로뿐만 아니라 하드 코딩된 IP 주소, 포트 번호도 테스트를 어렵게 만든다.
* 의존 객체를 직접 생성
  * 테스트를 어렵게 만드는 또 다른 요인은 의존 대상을 직접 생성하고 있다는 점이다.
  * 테스트를 실행하면 데이터가 DB에 추가되므로 같은 테스트를 다시 실행하기 전에 기존에 들어간 데이터를 삭제해야 한다. 
  * 그렇지 않으면 중복 데이터로 인해 데이터 삽입에 실패하게 된다.
* 정적 메소드 사용
* 실행 시점에 따라 달라지는 결과
  * `LocalDateTime.now()`, `Random` 등을 이용하면 테스트를 실행하는 시점에 따라 테스트 결과가 달라지기 때문에 그 테스트는 믿을 수 없게 된다.
* 역할이 섞여 있는 코드
* 그 외 테스트가 어려운 코드
  * 메소드 중간에 소켓 통신 코드가 포함되어 있다.
  * 콘솔에서 입력을 받거나 결과를 콘솔에 출력한다.
  * 테스트 대상이 사용하는 의존 대상 클래스나 메소드가 final이다.
  * 테스트 대상의 소스를 소유하고 있지 않아 수정이 어렵다.

## 테스트 가능한 설계

* 하드 코딩된 상수를 생성자나 메소드 파라미터로 받기
* 의존 대상을 주입 받기
* 테스트하고 싶은 코드를 분리하기
* 시간이나 임의 값 생성 기능 분리하기
* 외부 라이브러리는 직접 사용하지 말고 감싸서 사용하기