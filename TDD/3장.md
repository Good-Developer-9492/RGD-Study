# 3장 테스트 코드 작성 순서

## 테스트 코드 작성 순서

순서는 다음과 같은 규칙에 따라 나온다.
* 쉬운 경우에서 어려운 경우로 진행
* 예외적인 경우에서 정상인 경우로 진행

### 초반에 복잡한 테스트부터 시작하면 안되는 이유

초반부터 다양한 조합을 검사하는 복잡한 상황을 테스트로 추가하면 해당 테스트를 통과시키기 위해 한 번에 구현해야 할 코드가 많아진다.

보통의 개발자는 한 번에 많은 코드를 만들다 보면 나도 모르게 버그를 만들고 나중에 버그를 잡기 위해 많은 시간을 허비하게 된다.  
코드작성 시간이 길어지면 집중력도 떨어져서 흐름이 자주 끊기게 된다.

### 구현하기 쉬운 테스트부터 시작하기

빠르게 테스트를 통과시킬 수 있다.

한 번에 구현하는 시간이 짧아지면 디버깅할 때 유리하다.

### 예외 상황을 먼저 테스트해야 하는 이유

다양한 예외 상황은 복잡한 if-else 블록을 동반할 때가 많다.

예외 상황에 따른 if-else 구조가 미리 만들어지기 때문에 많은 코드를 오나성한 뒤에 예외 상황을 반영할 때보다 코드 구조가 덜 바뀐다.

TDD를 하는 동안 예외 상황을 찾고 테스트에 반영하면 예외 상황을 처리하지 않아 발생하는 버그도 줄여준다.

### 완급 조절

처음 TDD로 구현할 때 어려운 것 중 하나는 한 번에 얼마만큼의 코드를 작성할 것인가이다.

1. 정해진 값을 리턴
2. 값 비교를 이용해서 정해진 값을 리턴
3. 다양한 테스트를 추가하면서 구현을 일반화

### 지속적인 리팩토링

테스트를 통과한 뒤에는 리팩토링을 진행한다.  
코드 중복은 대표적인 리팩토링 대상이다.  

지속적으로 리팩토링을 진행하면 코드 가독성이 높아진다.

> 테스트 대상 코드의 리팩토링 시점  
> 
> 테스트 대상 코드에서 상수를 변수로 바꾸거나 변수 이름을 변경하는 것과 같은 작은 리팩토링은 발견하면 바로 실행한다.   
> 메소드 추출과 같이 메소드의 구조에 영향을 주는 리팩토링은 큰 틀에서 구현 흐름이 눈에 들어오기 시작한 뒤에 진행한다.

## 테스트할 목록 정리하기

TDD를 시작할 때 테스트할 목록을 미리 정리하면 좋다.

테스트 과정에서 새로운 테스트 사례를 발견하면, 그 사례를 목록에 추가해서 놓치지 않도록 해야 한다.  
개발을 진행하다 보면 생각지도 못한 테스트 사례를 발견하기 마련이다.

테스트 목록을 적었다고 해서 테스트를 한 번에 다 작성하면 안 된다.  
수정할 코드가 많을수록 리팩토링에 대한 심리적 저항이 생기기 때문이다.

다루는 범위가 작고 개발 주기도 짧으므로 개발 집중력도 높아진다.

TDD는 리팩토링을 통해 지속해서 코드를 정리하는데 개발을 진행하다 보면 변경 범위가 매우 큰 리팩토링 거리를 발견할 때도 있다.  
이때는 리팩토링을 진행하지 말고 테스트를 통과시키는 데 집중한다.

## 구현이 막히면

과감하게 코드를 지우고 미련 없이 다시 시작한다.